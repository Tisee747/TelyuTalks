<!-- File: src/main/resources/templates/register.html (UPDATED & STANDALONE) -->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - TelyuTalks</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>

<main class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-7">
            <div class="text-center mb-4">
                <a th:href="@{/}" class="h1 text-decoration-none">TelyuTalks</a>
            </div>
            <h2 class="text-center mb-4">Create an Account</h2>
            
            <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

            <ul class="nav nav-pills nav-fill mb-4" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-student-tab" data-bs-toggle="pill" data-bs-target="#pills-student" type="button" role="tab">I am a Student</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-lecturer-tab" data-bs-toggle="pill" data-bs-target="#pills-lecturer" type="button" role="tab">I am a Lecturer</button>
                </li>
            </ul>

            <div class="tab-content" id="pills-tabContent">
                <!-- Student Registration Form -->
                <div class="tab-pane fade show active" id="pills-student" role="tabpanel">
                    <form th:action="@{/register/student}" method="post">
                        <div class="row g-3">
                            <div class="col-md-6"><label class="form-label">Nama Lengkap</label><input type="text" name="nama" class="form-control" required></div>
                            <div class="col-md-6"><label class="form-label">Username</label><input type="text" name="username" class="form-control" required></div>
                            <div class="col-md-6"><label class="form-label">NIM</label><input type="text" name="nim" class="form-control" required></div>
                            <div class="col-md-6"><label class="form-label">Email Universitas</label><input type="email" name="email" class="form-control" placeholder="nama@student.telkomuniversity.ac.id" required></div>
                            <div class="col-md-6"><label class="form-label">Password</label><input type="password" name="password" class="form-control" required></div>
                            <div class="col-md-6"><label class="form-label">Angkatan</label><input type="text" name="angkatan" class="form-control" placeholder="e.g., 2022" required></div>
                            <div class="col-md-6">
                                <label for="studentFakultas" class="form-label">Fakultas</label>
                                <select id="studentFakultas" name="fakultas" class="form-select" required>
                                    <option value="" selected disabled>Pilih Fakultas</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="studentProdi" class="form-label">Program Studi</label>
                                <select id="studentProdi" name="programStudi" class="form-select" required>
                                     <option value="" selected disabled>Pilih Program Studi</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 mt-4">Register as Student</button>
                    </form>
                </div>
                
                <!-- Lecturer Registration Form -->
                <div class="tab-pane fade" id="pills-lecturer" role="tabpanel">
                    <form th:action="@{/register/lecturer}" method="post">
                         <div class="row g-3">
                             <div class="col-md-6"><label class="form-label">Nama Lengkap & Gelar</label><input type="text" name="nama" class="form-control" required></div>
                             <div class="col-md-6"><label class="form-label">Username</label><input type="text" name="username" class="form-control" required></div>
                             <div class="col-md-6"><label class="form-label">NIDN / NIDK</label><input type="text" name="nidn" class="form-control" required></div>
                             <div class="col-md-6"><label class="form-label">Email Universitas</label><input type="email" name="email" class="form-control" placeholder="nama@telkomuniversity.ac.id" required></div>
                             <div class="col-12"><label class="form-label">Password</label><input type="password" name="password" class="form-control" required></div>
                             <div class="col-12">
                                <label for="lecturerFakultas" class="form-label">Fakultas</label>
                                <select id="lecturerFakultas" name="fakultas" class="form-select" required>
                                    <option value="" selected disabled>Pilih Fakultas</option>
                                </select>
                             </div>
                        </div>
                         <button type="submit" class="btn btn-primary w-100 mt-4">Register as Lecturer</button>
                    </form>
                </div>
            </div>
             <div class="text-center mt-4">
                <p>Already have an account? <a th:href="@{/login}">Login here</a></p>
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script th:inline="javascript">
    // Menunggu seluruh halaman dimuat sebelum menjalankan script
    document.addEventListener("DOMContentLoaded", function() {
        console.log("DOM loaded, running script..."); // Pesan untuk debugging

        const prodiData = {
            "Fakultas Informatika": ["S-1 Informatika", "S-1 Teknologi Informasi", "S-1 Rekayasa Perangkat Lunak", "S-1 Sains Data", "S-1 PJJ Informatika", "S-2 Informatika", "S-2 Keamanan Siber & Forensik Digital", "S-3 Informatika"],
            "Fakultas Teknik Elektro": ["S-1 Teknik Telekomunikasi", "S-1 Teknik Elektro", "S-1 Teknik Komputer", "S-1 Teknik Fisika", "S-1 Teknik Biomedis", "S-1 Teknik Sistem Energi", "S-2 Teknik Elektro", "S-3 Teknik Elektro"],
            "Fakultas Rekayasa Industri": ["S1-Teknik Industri", "S1-Sistem Informasi", "S1-Teknik Logistik", "S1-Manajemen Rekayasa", "S2-Teknik Industri", "S2-Sistem Informasi"],
            "Fakultas Ekonomi dan Bisnis": ["S1-Manajemen", "S1-Akuntasi", "S1-Manajemen Bisnis Rekreasi", "S1-Bisnis Digital", "S1-Administrasi Bisnis", "S2-Administrasi Bisnis", "S2-PJJ Manajemen", "S2-Manajemen", "S2-Akuntasi"],
            "Fakultas Komunikasi dan Ilmu Sosial": ["S1-Ilmu Komunikasi", "S1-Hubungan Masyarakat", "S1-Digital Content Brodcasting", "S1-Psikologi", "S2-Ilmu Komunikasi"],
            "Fakultas Industri Kreatif": ["S1-Desain Komunikasi Visual", "S1-Desain Produk", "S1-Desain Interior", "S1-Seni Rupa", "S1-Kriya", "S1-Film dan Animasi", "S2-Desain"],
            "Fakultas Ilmu Terapan": ["D3-Teknik Telekomunikasi", "D3-Rekayasa Perangkat Lunak Aplikasi", "D3-Sistem Informasi", "D3-Sistem Informasi Akuntansi", "D3-Teknologi Komputer", "D3-Digital Marketing", "D3-Hospitality & Culinary Art", "D4-Digital Creative Multimedia", "D4-Sistem Informasi Kota Cerdas"]
        };

        function setupStudentDropdowns() {
            const fakultasSelect = document.getElementById('studentFakultas');
            const prodiSelect = document.getElementById('studentProdi');
            
            Object.keys(prodiData).forEach(fakultas => {
                fakultasSelect.add(new Option(fakultas, fakultas));
            });

            fakultasSelect.addEventListener('change', event => {
                const selectedFakultas = event.target.value;
                // Bersihkan prodi setiap kali fakultas berubah
                prodiSelect.innerHTML = '<option value="" selected disabled>Pilih Program Studi</option>'; 
                if (prodiData[selectedFakultas]) {
                    prodiData[selectedFakultas].forEach(prodi => {
                        prodiSelect.add(new Option(prodi, prodi));
                    });
                }
            });
        }

        function setupLecturerDropdown() {
            const lecturerFakultasSelect = document.getElementById('lecturerFakultas');
            Object.keys(prodiData).forEach(fakultas => {
                lecturerFakultasSelect.add(new Option(fakultas, fakultas));
            });
        }
        
        setupStudentDropdowns();
        setupLecturerDropdown();
    });
</script>

</body>
</html>
